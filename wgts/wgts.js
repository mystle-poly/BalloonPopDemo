var xa;xa=apn.inheritWidget(apn.widgets["apn.wgt.image"]),xa.editor={},xa.editor.iconThumb="DB/EDU/imgs/wgts/thumbs/spriteAnimation.png",xa.editor.states={play:"Play",loop:"Loop",stop:"Stop"},xa.properties.state="stop",xa.properties.attrs={apxAnimate:!0,cfg:{frames:[{sprite:{mediaID:void 0},duration:42}],idStep:""}},xa.onEdit=void 0,xa.exeCreateTag=apn.widgets["apn.wgt.rect"].exeCreateTag,xa.exeRenderTag=apn.widgets["apn.wgt.rect"].exeRenderTag,xa.exeAssetLoad=void 0,xa.exeAssetPreload=function(t,e,a){function i(i,s,c){a(),uxWgtImgSprite._frame(t,n,n.ctx.cur),r.exeOnCheckContentLoad&&t.fireEvent("contentLoad","i",e,!0)}var r=this,n=t.wgtTag(e);n.ctx={},n.ctx.frames=[],n.ctx.cur=0,n.ctx.action=0,n.ctx.lastTickTime=0;for(var s=t.wgtGetProperty(e,"cfg"),c=0,o={},d=0;d<s.frames.length;d++)buf=bx.$cloneObject({},s.frames[d]),buf.duration=bx.$checkNaN(parseInt(buf.duration)),buf.sprite.mediaID&&buf.duration&&(o["sp"+d]={url:t.mediaURL(s.frames[d].sprite.mediaID)},c++,buf.img=o["sp"+d],n.ctx.frames.push(buf));c?(new apn.CRscLoader).load(t.project,o,i):a()},xa.exeOnLoad=function(t,e){function a(a,n){if(a==r.idStep&&n){if(!i.ctx.frames[n.current])return void t.log(e,"Invalid frame was requested to display by step interface. FrameIndex="+n.current);i.ctx.cur!=n.current&&n.current<i.ctx.frames.length&&(i.ctx.cur=n.current,uxWgtImgSprite._frame(t,i,i.ctx.cur))}}var i=t.wgtTag(e),r=t.wgtGetProperty(e,"cfg");if(bx.HCL.DV.isIE()&&bx.HCL.DV.isIE()<9?i.img=i.$TAG("img",{style:"cursor:inherit;position:absolute;left:0px;top:0px;width:100%;height:100%;"}):(i.canvas=i.$TAG("canvas",{style:"cursor:inherit;position:absolute;left:0px;top:0px;width:100%;height:100%;"}),i.canvas.width=parseInt(i.style.width),i.canvas.height=parseInt(i.style.height)),uxWgtImgSprite._frame(t,i,i.ctx.cur),r.idStep){t.wgtListenProperty(e,"apxStep",a)}},xa.exeOnCheckContentLoad=function(t,e,a){return{i:"Image"}},xa.exeSetState=function(t,e,a,i){"stop"==a?this._stop(t,e,!0):"play"==a?(e.ctx.action=1,e.ctx.lastTickTime=0,t.fireEvent("animation","Start",t.wgtId(e))):"loop"==a&&(e.ctx.action=2,e.ctx.lastTickTime=0,t.fireEvent("animation","Start",t.wgtId(e)))},xa.exeOnTick=function(t,e,a){var i=t.wgtTag(e);if(i.ctx&&i.ctx.frames.length&&0!=i.ctx.action){i.ctx._onceStarted=!0;var r;0==i.ctx.lastTickTime?(i.ctx.cur=0,r=!0):i.ctx.lastTickTime<a&&(r=!0,2==i.ctx.action?i.ctx.cur=(i.ctx.cur+1)%i.ctx.frames.length:(i.ctx.cur++,i.ctx.cur==i.ctx.frames.length&&(i.ctx.cur=0,this._stop(t,i),r=!1))),r&&(i.ctx.lastTickTime=a+parseInt(i.ctx.frames[i.ctx.cur].duration),uxWgtImgSprite._frame(t,i,i.ctx.cur))}},xa._frame=function(t,e,a){if(e.ctx.frames[a]&&e.ctx.frames[a].img.image)if(e.canvas){var i=e.canvas.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height),i.drawImage(e.ctx.frames[a].img.image,0,0,i.canvas.width,i.canvas.height)}else e.img&&(e.img.src=e.ctx.frames[a].img.url)},xa._stop=function(t,e,a){e.ctx.action=0,e.ctx.lastTickTime=0,a&&e.ctx.frames[0]&&e.ctx.frames[0].sprite.mediaID&&(e.ctx.cur=0,uxWgtImgSprite._frame(t,e,0)),e.ctx._onceStarted&&t.fireEvent("animation","End",t.wgtId(e))},xa.edtSetupStep=function(t,e,a,i){var r=t.getScreenData(),n=[{title:apn.CExe.GL({ko:"[없음]",en:"[None]"}),value:""}];for(var s in r.objects)r.objects[s].create&&r.objects[s].create.data&&r.objects[s].create.data.properties&&r.objects[s].create.data.properties.attrs&&r.objects[s].create.data.properties.attrs.apxStep&&n.push({value:s,title:t.itrGetObjectTitle(s)});eduLib.edtInputAdd(t,a,{type:"select",options:n,title:apn.CExe.GL({ko:"연동할 위젯",en:"Widget to interface with"}),key:"idStep",value:i,join:!0})},xa.edtOnConfig=function(t,e){function a(){eduLib.edtInputApplyAll(t,r.tagTab1),eduLib.edtInputApplyAll(t,r.tagTab2),n.frames[0].sprite.mediaID&&t.wgtSetProperty(e,"apxMediaID",n.frames[0].sprite.mediaID),t.wgtSetProperty(e,"cfg",n),t.wgtRefreshUI(e)}function i(){for(var t in s)s[t]&&(this.id==t?(r[t].style.display="block",r.tagTab.$$(t).style.borderStyle="solid solid none solid"):(r[t].style.display="none",r.tagTab.$$(t).style.borderStyle="none none solid none"));uxWgtImgSprite._uiLastSetupTab=this.id}var r,n=t.wgtGetProperty(e,"cfg"),s={tagTab1:!0,tagTab2:!0};if(r=t.dlgDoModal(600,Math.ceil(.9*bx.UX.height),a)){var c=apn.CExe.CSS_SETUP_PANE+"height:"+(r.clientHeight-40)+"px";r.tagTab=r.$TAG("div",{style:"position:relative;font-weight:bold;width:100%;height:26px;padding-bottom:14px;"}),r.tagTab.innerHTML='<span id="tagTab1" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스프라이트",en:"Sprite Sheet"})+'</span><span id="tagTab2" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스텝 연동",en:"Step Interface"})+"</span>"+apn.CExe.CSS_SETUP_TAB_END,r.tagTab.$$("tagTab1").onclick=r.tagTab.$$("tagTab2").onclick=i,r.tagTab1=r.$TAG("div",{style:c}),r.tagTab2=r.$TAG("div",{style:c}),eduLib.edtInputAdd(t,r.tagTab1,{type:"table",value:n.frames,options:{th:[apn.CExe.GL({ko:"프레임 이미지",en:"Frame image"}),apn.CExe.GL({ko:"프레임 시간",en:"Duration"})+"[ms]"],add:!0,remove:!0,order:!0},td:[{type:"image",key:"sprite"},{type:"text",key:"duration",width:"110px"}],join:!0}),eduLib.edtInputAdd(t,r.tagTab1,{type:"message",value:"※ "+apn.CExe.GL({ko:"과도한 이미지의 사용은 HTML5 컨텐츠의 성능을 크게 저하시킵니다. 그러한 경우, Video로 제작하거나 Scene Animation으로 편집하는 것이 좋습니다.",en:"Excessive image resources will slow down HTML5 contents. In that case, video or Scene Animation is better."}),join:!0}),this.edtSetupStep(t,e,r.tagTab2,n),void 0!==uxWgtImgSprite._uiLastSetupTab&&r.tagTab.$$(uxWgtImgSprite._uiLastSetupTab)?r.tagTab.$$(uxWgtImgSprite._uiLastSetupTab).onclick():r.tagTab.$$("tagTab1").onclick(),r.tagTab.$$("tagBlank").style.width=r.clientWidth-r.tagTab.$$("tagBlank").offsetLeft-1+"px"}},xa.edtOnRemapObjectID=function(t,e,a){if(e&&e.properties&&e.properties.attrs&&e.properties.attrs.cfg){var i=e.properties.attrs.cfg;i.idStep&&(a[i.idStep]?i.idStep=a[i.idStep]:t.getScreenData().objects[i.idStep]||(i.idStep=""))}},uxWgtImgSprite=xa,xa=apn.inheritWidget(uxWgtImgSprite),xa.properties.attrs.imgCropSprite=!0,xa.properties.attrs.ver=2,xa.properties.attrs.cfg={ty:"s",mr:0,s:{img:{mediaID:void 0},w:64,h:64,cnt:1,cols:0,x:0,y:0,tm:42},f:{file:{size:0,data:""},edt:{}},idStep:""},xa.scriptInfo={wgtData:{sheet:{help:"{type:'simple', data:{img:{mediaID:id}, w:Number, h:Number, cnt:Number, x:Number, y:Number, tm:Msec}\nSprite sheet data.",type:"so"}}},xa.exeCreateTag=apn.widgets["apn.wgt.rect"].exeCreateTag,xa.exeRenderTag=function(t,e,a,i,r,n){return apn.widgets["apn.wgt.rect"].exeRenderTag.call(this,t,e,a,i,r,n),a.tagOnPostResize=function(t,e){if(e.ctx.cellHolder){var a=t.wgtGetProperty(e.apnOID,"cfg"),i=1,r=parseInt(e.style.width)/(a.s.w*i),n=parseInt(e.style.height)/(a.s.h*i);r=parseInt(e.style.width)/a.s.w,n=parseInt(e.style.height)/a.s.h,e.ctx.cellHolder.$CSS({transform:"scale("+r*i+","+n*i+")",transformOrigin:"0px 0px"})}},a},xa.exeAssetPreload=function(t,e,a){function i(i,o,d){r.ctx.image=s.sp.image,c._loadSpriteSheet(t,e,n),a(),c.exeOnCheckContentLoad&&t.fireEvent("contentLoad","i",e,!0)}var r=t.wgtTag(e);r.ctx={},r.ctx.cur=0,r.ctx.action=0,r.ctx.lastTickTime=0,r.ctx.frames=[];var n=t.wgtGetProperty(e,"cfg");if(n.s.img.mediaID){var s={},c=this;s.sp={url:t.mediaURL(n.s.img.mediaID)},(new apn.CRscLoader).load(t.project,s,i)}else a()},xa.exeOnCheckContentLoad=function(t,e,a){return{i:"Image"}},xa.exeOnLoad=function(t,e){function a(a,i){function n(a,n,o){a==n&&(r.ctx.image=c.sp.image,i.data.h=c.sht.image.height,i.data.w=Math.max(1,c.sht.image.width/i.data.cnt),s._loadSpriteSheet(t,e,{ty:"s",s:i.data}))}if(a==e&&i&&i.type&&i.data&&i.data.img&&i.data.img.mediaID&&i.data.cnt&&"simple"==i.type)if(i.data.w&&i.data.h)s._loadSpriteSheet(t,e,{ty:"s",s:i.data});else{var c={};c.sht={url:t.mediaURL(i.data.img.mediaID)},(new apn.CRscLoader).load(t.project,c,n)}}function i(a,i){if(a==n.idStep&&i){if(!r.ctx.frames[i.current])return void t.log(e,"Invalid frame was requested to display by step interface. FrameIndex="+i.current);r.ctx.cur!=i.current&&i.current<r.ctx.frames.length&&(r.ctx.cur=i.current,s._render(t,r,r.ctx.frames[r.ctx.cur]))}}var r=t.wgtTag(e),n=t.wgtGetProperty(e,"cfg"),s=this;if(t.wgtListenProperty(e,"sheet",a),n.idStep){var s=this;t.wgtListenProperty(e,"apxStep",i)}},xa._loadSpriteSheet=function(t,e,a){var i=t.wgtTag(e);if(i){if("s"==a.ty&&a.s.img.mediaID&&a.s.w&&a.s.h&&a.s.cnt&&a.s.tm)for(var r=a.s.cols||a.s.cnt,n=x=bx.$checkNaN(parseInt(a.s.x))||0,s=bx.$checkNaN(parseInt(a.s.y))||0,c=0;c<a.s.cnt;c++)i.ctx.frames[c]={x:x,y:s,w:a.s.w,h:a.s.h,offX:0,offY:0,tm:a.s.tm},x+=a.s.w,(c+1)%r==0&&(x=n,s+=a.s.h);else if("f"==a.ty&&a.f&&a.f.file&&a.f.file.data){try{var o=JSON.parse(a.f.file.data)}catch(a){t.log(e,"JSON file parsing error:"+a)}if(o&&o.frames)for(var c in o.frames)o.frames[c].frame&&i.ctx.frames.push({x:o.frames[c].frame.x,y:o.frames[c].frame.y,w:o.frames[c].frame.w,h:o.frames[c].frame.h,offX:o.frames[c].spriteSourceSize.x,offY:o.frames[c].spriteSourceSize.y,tm:a.s.tm})}i.ctx.useCanvas=!1,2!=t.wgtGetProperty(e,"ver")||bx.HCL.DV.isIE()&&bx.HCL.DV.isIE()<9||(i.ctx.useCanvas=!0),i.ctx.cellInfo=a,i.ctx.useCanvas?(i.ctx.cell=i.$TAG("canvas",{style:"cursor:inherit;position:absolute;left:0px;top:0px;width:100%;height:100%;"}),i.ctx.cell.width=parseInt(i.style.width),i.ctx.cell.height=parseInt(i.style.height),i.ctx.cvsCtx=i.ctx.cell.getContext("2d"),a.mr&&(1==a.mr?(i.ctx.cell.$CSS("transformOrigin","50% 50%"),i.ctx.cell.$CSS("transform","rotateY(180deg)")):2==a.mr?(i.ctx.cell.$CSS("transformOrigin","50% 50%"),i.ctx.cell.$CSS("transform","rotateX(180deg)")):3==a.mr&&(i.ctx.cell.$CSS("transformOrigin","50% 50%"),i.ctx.cell.$CSS("transform","rotateX(180deg) rotateY(180deg)"))),i.ctx.frames.length&&this._render(t,i,i.ctx.frames[0])):(a.mr?(i.ctx.cellHolderMr=i.ctx.cellHolderMr||i.$TAG("div",{style:"cursor:inherit;width:100%;height:100%;"}),i.ctx.cellHolder=i.ctx.cellHolder||i.ctx.cellHolderMr.$TAG("div"),1==a.mr?(i.ctx.cellHolderMr.$CSS("transformOrigin","50% 50%"),i.ctx.cellHolderMr.$CSS("transform","rotateY(180deg)")):2==a.mr?(i.ctx.cellHolderMr.$CSS("transformOrigin","50% 50%"),i.ctx.cellHolderMr.$CSS("transform","rotateX(180deg)")):3==a.mr&&(i.ctx.cellHolderMr.$CSS("transformOrigin","50% 50%"),i.ctx.cellHolderMr.$CSS("transform","rotateX(180deg) rotateY(180deg)"))):i.ctx.cellHolder=i.ctx.cellHolder||i.$TAG("div"),i.ctx.cellHolder.$A({style:"cursor:inherit;width:"+a.s.w+"px;height:"+a.s.h+"px"}),i.ctx.cell=i.ctx.cell||i.ctx.cellHolder.$TAG("div"),i.ctx.cell.$A({style:"cursor:inherit;position:absolute;left:0px;top:0px;width:"+a.s.w+"px;height:"+a.s.h+"px"}),i.ctx.frames.length&&(i.tagOnPostResize(t,i),i.ctx.cell.style.backgroundImage="url("+t.mediaURL(a.s.img.mediaID)+")",i.ctx.cell.style.backgroundRepeat="no-repeat",this._render(t,i,i.ctx.frames[0])))}},xa.exeOnTick=function(t,e,a){var i=t.wgtTag(e);if(i.ctx.frames.length&&0!=i.ctx.action){i.ctx._onceStarted=!0;var r;0==i.ctx.lastTickTime?(i.ctx.cur=0,r=!0):i.ctx.lastTickTime<a&&(r=!0,2==i.ctx.action?i.ctx.cur=(i.ctx.cur+1)%i.ctx.frames.length:(i.ctx.cur++,i.ctx.cur==i.ctx.frames.length&&(i.ctx.cur=0,this._stop(t,i),r=!1))),r&&(i.ctx.lastTickTime=a+i.ctx.frames[i.ctx.cur].tm,this._render(t,i,i.ctx.frames[i.ctx.cur]))}},xa._render=function(t,e,a){if(e.ctx.useCanvas)e.ctx.image&&(e.ctx.cvsCtx.clearRect(0,0,e.ctx.cell.width,e.ctx.cell.height),e.ctx.cvsCtx.drawImage(e.ctx.image,a.x,a.y,a.w,a.h,Math.round(a.offX*(1/t.getZoomX())),Math.round(a.offY*(1/t.getZoomY())),e.ctx.cell.width-Math.round(a.offX*(1/t.getZoomX())),e.ctx.cell.height-Math.round(a.offY*(1/t.getZoomY()))));else{var i=e.ctx.cell.style;i.left!=a.offX+"px"&&(i.left=a.offX+"px"),i.top!=a.offY+"px"&&(i.top=a.offY+"px"),i.width!=a.w+"px"&&(i.width=a.w+"px"),i.height!=a.h+"px"&&(i.height=a.h+"px"),i.backgroundPosition=-a.x+"px "+-a.y+"px"}},xa._stop=function(t,e,a){e.ctx.action=0,e.ctx.lastTickTime=0,a&&e.ctx.frames[0]&&this._render(t,e,e.ctx.frames[0]),e.ctx._onceStarted&&t.fireEvent("animation","End",t.wgtId(e))},xa.edtOnConfig=function(t,e){function a(){if(eduLib.edtInputApplyAll(t,s.tagTab1),eduLib.edtInputApplyAll(t,s.tagTab2),n.s.img.mediaID&&t.wgtSetProperty(e,"apxMediaID",n.s.img.mediaID),"f"==n.ty&&(n.f.edt.w=n.f.edt.h=0,n.f.file.data)){try{var a=JSON.parse(n.f.file.data)}catch(t){}if(a&&a.frames)for(var i in a.frames){n.f.edt.x=a.frames[i].frame.x,n.f.edt.y=a.frames[i].frame.y,n.f.edt.w=a.frames[i].frame.w,n.f.edt.h=a.frames[i].frame.h,n.f.edt.offX=a.frames[i].spriteSourceSize.x,n.f.edt.offY=a.frames[i].spriteSourceSize.y,n.s.w=a.frames[i].sourceSize.w,n.s.h=a.frames[i].sourceSize.h;break}}t.wgtSetProperty(e,"ver",2),t.wgtSetProperty(e,"cfg",n),t.wgtRefreshUI(e)}function i(){"s"==this.value?(eduLib.edtInputShow(t,s.tagTab1,"s",!0),eduLib.edtInputShow(t,s.tagTab1,"f",!1)):(eduLib.edtInputShow(t,s.tagTab1,"f",!0),eduLib.edtInputShow(t,s.tagTab1,"s",!1))}function r(){for(var t in c)c[t]&&(this.id==t?(s[t].style.display="block",s.tagTab.$$(t).style.borderStyle="solid solid none solid"):(s[t].style.display="none",s.tagTab.$$(t).style.borderStyle="none none solid none"));uxWgtShtSprite._uiLastSetupTab=this.id}var n=t.wgtGetProperty(e,"cfg");n.f=n.f||{file:{size:0,data:""},edt:{}};var s,c={tagTab1:!0,tagTab2:!0};if(s=t.dlgDoModal(600,700,a)){var o=apn.CExe.CSS_SETUP_PANE+"height:"+(s.clientHeight-40)+"px";s.tagTab=s.$TAG("div",{style:"position:relative;font-weight:bold;width:100%;height:26px;padding-bottom:14px;"}),s.tagTab.innerHTML='<span id="tagTab1" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스프라이트",en:"Sprite Sheet"})+'</span><span id="tagTab2" style="'+apn.CExe.CSS_SETUP_TAB+'">'+apn.CExe.GL({ko:"스텝 연동",en:"Step Interface"})+"</span>"+apn.CExe.CSS_SETUP_TAB_END,s.tagTab.$$("tagTab1").onclick=s.tagTab.$$("tagTab2").onclick=r,s.tagTab1=s.$TAG("div",{style:o}),s.tagTab2=s.$TAG("div",{style:o}),eduLib.edtInputAdd(t,s.tagTab1,{type:"image",title:apn.CExe.GL({ko:"스프라이트 시트 이미지",en:"Sprite sheet image"}),value:n.s,key:"img",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{type:"message",value:"※ "+apn.CExe.GL({ko:"과도한 이미지의 사용은 HTML5 컨텐츠의 성능을 크게 저하시킵니다. 그러한 경우, Video로 제작하거나 Scene Animation으로 편집하는 것이 좋습니다.",en:"Excessive image resources will slow down HTML5 contents. In that case, video or Scene Animation is better."}),join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{type:"space"}),eduLib.edtInputAdd(t,s.tagTab1,{type:"title",title:apn.CExe.GL({ko:"프레임 구성 정보",en:"Frame information"})}),eduLib.edtInputAdd(t,s.tagTab1,{type:"select",title:apn.CExe.GL({ko:"스프라이트 시트 구성",en:"Sprite sheet type"}),value:n,key:"ty",options:[{title:"Simple",value:"s"},{title:"Adobe Animate - JSON",value:"f"}],onchange:i,join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{type:"number",title:apn.CExe.GL({ko:"프레임 시간",en:"Duration"})+"[ms] (m)",value:n.s,key:"tm",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 너비",en:"Cell width"})+"[px] (m)",value:n.s,key:"w",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 높이",en:"Cell height"})+"[px](m)",value:n.s,key:"h",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 개수",en:"Cell count"})+" (m)",value:n.s,key:"cnt",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"프레임 셀 열의 수",en:"Column count"}),value:n.s,key:"cols",comment:"("+apn.CExe.GL({ko:"1개 행으로 구성된 경우, 0을 입력",en:"0 if cells are aligned in one line"})+")",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"시작 X좌표",en:"Start X"})+"[px]",value:n.s,key:"x",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"s",type:"number",title:apn.CExe.GL({ko:"시작 Y좌표",en:"Start Y"})+"[px]",value:n.s,key:"y",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{id:"f",type:"file",title:apn.CExe.GL({ko:"프레임 구성 정보 파일",en:"Frame information file"}),value:n.f,key:"file",join:!0}),eduLib.edtInputAdd(t,s.tagTab1,{type:"space"}),eduLib.edtInputAdd(t,s.tagTab1,{type:"title",title:apn.CExe.GL({ko:"대칭 변환",en:"Mirror transformation"})}),eduLib.edtInputAdd(t,s.tagTab1,{type:"select",title:apn.CExe.GL({ko:"방향",en:"Direction"}),value:n,key:"mr",options:[{title:apn.CExe.GL({ko:"가로",en:"Horizontal"}),value:1},{title:apn.CExe.GL({ko:"세로",en:"Vertical"}),value:2},{title:apn.CExe.GL({ko:"가로&세로",en:"Both"}),value:3},{title:apn.CExe.GL({ko:"안함",en:"None"}),value:0}],join:!0}),uxWgtImgSprite.edtSetupStep(t,e,s.tagTab2,n),void 0!==uxWgtShtSprite._uiLastSetupTab&&s.tagTab.$$(uxWgtShtSprite._uiLastSetupTab)?s.tagTab.$$(uxWgtShtSprite._uiLastSetupTab).onclick():s.tagTab.$$("tagTab1").onclick(),s.tagTab.$$("tagBlank").style.width=s.clientWidth-s.tagTab.$$("tagBlank").offsetLeft-1+"px"}},xa.edtOnFitToSize=function(t,e,a){if(a.cfg.s&&a.cfg.s.w&&a.cfg.s.h)return{w:a.cfg.s.w,h:a.cfg.s.h}},uxWgtShtSprite=xa;
var xa=apn.inheritWidget(apn.widgets["apn.wgt.audio"]);xa.styleMap.visibility=!1,xa.APX_NO_POINTER_EV=!0,xa.editor.properties=void 0,xa.editor.states={play:"Play",stop:"Stop",resume:"Resume",pause:"Pause",mute:"Mute",muteOff:"Mute Off"},xa.properties.attrs.Control="None",xa.dvReady=function(){return window.location.href.indexOf("plyr.ifox.kr")!=-1||!!(window.ply&&ply.dv&&window.polyAudioApi)&&ply.dv.isEnabled()},xa.mediaParentClass=apn.widgets["apn.wgt.audio"],xa.dvPlayerCreate=function(e,a){a.id=e.getPageID()+"_"+a.apnOID,polyAudioApi.PATH_SWF=e.localMediaURL(a.apnOID,"player_aspen.swf"),a.mediaTag=new polyAudioApi(a.id)},xa.dvPlayerHandler=function(e,a){function i(){e.wgtSetProperty(a.apnOID,"apxState","play",!0),console.error("onStart"),a.exeOnMediaEvent&&(a.exeOnMediaEvent("listStart"),a.exeOnMediaEvent("trackStart",1,1)),e.fireEvent("media","Start",a.apnOID)}function t(){e.wgtSetProperty(a.apnOID,"apxState","stop",!0),console.error("onEnd"),e.fireEvent("media","trackEndN",a.apnOID),e.fireEvent("media","End",a.apnOID),a.exeOnMediaEvent&&a.exeOnMediaEvent("trackEnd")}function n(){console.error("onTimeDuration",a.mediaTag.infoPlayTime()||0,a.mediaTag.infoDuration()),a.exeOnMediaEvent&&a.exeOnMediaEvent("infoDuration",a.mediaTag.infoPlayTime()||0,a.mediaTag.infoDuration())}function d(){a.exeOnMediaEvent&&a.exeOnMediaEvent("infoPlayTime",a.mediaTag.infoPlayTime()||0,a.mediaTag.infoDuration())}function o(){a.exeOnMediaEvent&&a.exeOnMediaEvent("volumeChange",a.mediaTag.getVolume())}a.mediaTag.trackStart(i),a.mediaTag.onended(t),a.mediaTag.onLoad(n),a.mediaTag.timeUpdate(d),a.mediaTag.volumeChange(o),a.mediaTag.trackPause&&a.mediaTag.trackPause(t),a.mediaTag.trackStop&&a.mediaTag.trackStop(t),a.mediaTag.__apxOnStop=function(){t()},a.mediaTag.__apxOnPause=function(){e.wgtSetProperty(a.apnOID,"apxState","pause",!0),e.fireEvent("media","Pause",a.apnOID),a.exeOnMediaEvent&&a.exeOnMediaEvent("trackPause")}},xa.exeCreateTag=function(e,a,i,t,n){if(this.dvReady()){var d=document.body.$TAG("DIV",{style:"position:absolute;overflow:hidden;"});return d.$CSS({boxSizing:"border-box"}),d.apnCur={},d}return this.mediaParentClass.exeCreateTag.call(this,e,a,i,t,n)},xa.exeRenderTag=function(e,a,i,t,n,d){return this.mediaParentClass.exeRenderTag.call(this,e,a,i,t,n,d),this.dvReady()&&(this.dvPlayerCreate(a,i),this.dvPlayerHandler(a,i)),i},xa.exeOnLoad=function(e,a){this.mediaParentClass.exeOnLoad&&this.mediaParentClass.exeOnLoad.call(this,e,a);var i=e.wgtTag(a);i.style.display="block",i.style.width="0px",i.style.height="0px"},xa.exeAssetLoad=function(e,a,i,t){this.dvReady()?(i||(i=e.wgtGetProperty(a.apnOID,"apxMediaID")),i&&(a.mediaTag.src(e.mediaURL(i)||i),a.exeOnMediaEvent&&a.exeOnMediaEvent("listSet",1))):this.mediaParentClass.exeAssetLoad.call(this,e,a,i,t)},xa.exeMediaPlay=function(e,a,i,t){this.dvReady()?(console.error("call play",a),a?e.mediaTag.currentTime(0):this.exeMediaInfo(e,"pause")&&e.mediaTag.play()):this.mediaParentClass.exeMediaPlay.call(this,e,a,i,t)},xa.exeMediaPause=function(e){this.dvReady()?(console.error("call pause"),this.exeMediaInfo(e,"pause")||(e.mediaTag.pause(),e.mediaTag.__apxOnPause&&e.mediaTag.__apxOnPause())):this.mediaParentClass.exeMediaPause.call(this,e)},xa.exeMediaStop=function(e,a){this.dvReady()?(console.error("call try stop state:"+e.mediaTag.stated()),this.exeMediaInfo(e,"pause")||(console.error("call stop"),e.mediaTag.stop(),e.mediaTag.__apxOnStop&&e.mediaTag.__apxOnStop())):this.mediaParentClass.exeMediaStop.call(this,e,a)},xa.exeMediaSeek=function(e,a,i,t){if(this.dvReady()){if(e.mediaTag&&e.mediaTag.infoDuration()){var n=0;if(n="string"==typeof a?bx.$checkNaN(parseFloat(a))/100*e.mediaTag.infoDuration():a,n=Math.min(n,e.mediaTag.infoDuration()),t){if(void 0!==e.__lastSeeked&&Math.abs(e.__lastSeeked-n)<1)return;e.__lastSeeked=n}i||this.exeMediaInfo(e,"pause")||e.mediaTag.pause(),i&&(console.error("call seek",n,e.mediaTag.infoPlayTime()),e.mediaTag.currentTime(n)),e.mediaTag.apnOnSeek&&e.mediaTag.apnOnSeek(n),e.exeOnMediaEvent&&e.exeOnMediaEvent("infoPlayTime",n,e.mediaTag.infoDuration()||0)}}else this.mediaParentClass.exeMediaSeek.call(this,e,a,i,t)},xa.exeMediaControl=function(e,a,i){return this.dvReady()?"mute"==a?(e.mediaTag.muted(i),!0):"loop"==a?(e.mediaTag.setLoop(i),!0):"volume"==a&&(e.mediaTag.setVolume(i),!0):this.mediaParentClass.exeMediaControl.call(this,e,a,i)},xa.exeMediaInfo=function(e,a){return this.dvReady()?"volume"==a?e.mediaTag.getVolume():"mute"==a?e.mediaTag.getMuted():"loop"==a?e.mediaTag.getLoop():"pause"==a?"play"!=e.mediaTag.stated():"end"==a?"stop"==e.mediaTag.stated():"currentTime"==a?e.mediaTag.infoPlayTime()||0:void 0:this.mediaParentClass.exeMediaInfo.call(this,e,a)},xa.edtOnBuildEvent=function(e,a,i,t){t.media={value:"media",title:apn.P.eventTitle.media,param:{Start:"Start",End:"End",trackEndN:"TrackEndNormal"}}},plyWgtAudio=xa;
var xa={APX_NO_POINTER_EV:!0};xa.styleMap={title:!0},xa.exeItrNoResize=!0,xa.exeItrNoZoom=!0,xa.exeItrNoMove=!0,xa.apdConfigReadOnly=!0,xa.scriptInfo={wgtRun:{setField:{param:"{row:0-based Number, name:String, value:Value}",help:{ko:"항목의 값을 지정합니다. 'name'은 항목(열)의 이름입니다.",en:"Set/change value of a field. 'name' is the name of field(column)."}}}},xa.apnCImage={url:"DB/ux/imgs/wgts/edit/dataTable.png"},xa.properties={attrs:{st:[{t:"Name",c:"",o:"",type:"text",w:0}],data:{idx:1,st:{},tbl:[{}],maxCount:0,o:""}}},xa.createAsCanvasObject=function(t,e,a,r,n){return apn.IWidget.createCanvasObject(t,this,"apn.CImage",bx.CCanvasWnd.SHAPE_RECT,e,a,r,n,void 0,apn.CEditorS.NO_RESIZE)},xa.exeCreateTag=function(t,e,a,r,n,o){var i=document.body.$TAG("div",{style:"position:absolute;overflow:hidden;"});return i.apnCur={},o&&e.wgtHide&&e.wgtHide(o),i},xa.exeRenderTag=function(t,e,a,r,n,o){return a},xa.exeOnLoad=function(t,e){function a(a,r){if(a==e&&r&&void 0!==r.row&&void 0!==r.name){var n=t.wgtGetProperty(e,"data");if(!n.tbl[r.row])return void t.log(e,"Unexisting tuple of data accessed by 'row'. row="+r.row);for(var o in n.st)if(n.st[o].t==r.name)return void("image"==n.st[o].type||"audio"==n.st[o].type||"video"==n.st[o].type?n.tbl[r.row][o].mediaID=r.value:0==n.st[o].type.indexOf("file")?n.tbl[r.row][o].data=r.value:n.tbl[r.row][o]=r.value);t.log(e,"Unexisting 'name' of field. name='"+r.name+"'")}}t.wgtTag(e);t.wgtListenProperty(e,"setField",a)},xa.exeInputGet=function(t,e){for(var a,r=[],n=t.wgtGetProperty(e.apnOID,"data"),o=0;o<n.tbl.length;o++){r.push([]);for(a in n.tbl[o])n.tbl[o][a]instanceof Object&&void 0!==n.tbl[o][a].data?r[r.length-1].push(n.tbl[o][a]):n.tbl[o][a]instanceof Object?r[r.length-1].push(n.tbl[o][a].mediaID):r[r.length-1].push(n.tbl[o][a])}return r},xa.edtOnInputGet=function(t,e,a){var r,n=[];if((r=t.pages[e].objects[a].create.data)&&r.properties&&r.properties.attrs&&r.properties.attrs.data){r=r.properties.attrs.data;for(var o,i=0;i<r.tbl.length;i++){n.push([]);for(o in r.tbl[i])r.tbl[i][o]instanceof Object&&void 0!==r.tbl[i][o].data?n[n.length-1].push(r.tbl[i][o]):r.tbl[i][o]instanceof Object?n[n.length-1].push(r.tbl[i][o].mediaID):n[n.length-1].push(r.tbl[i][o])}}return JSON.stringify(n).replace(/\\r/g,"")},xa.edtOnConfig=function(t,e,a,r,n){function o(){t.wgtSetProperty(e,"st",i),t.wgtSetProperty(e,"data",l)}var i=t.wgtGetProperty(e,"st"),l=t.wgtGetProperty(e,"data");n&&n.readOnly&&(n.title=t.itrGetObjectTitle(e)),eduLib.showDataDialog(t,{st:t.wgtGetProperty(e,"st"),data:t.wgtGetProperty(e,"data")},null,o,n)},xa.pubOnGetText=function(t,e,a){for(var r,n=t.pages[e].objects[a].create.data.properties.attrs.data,o="",i=0;i<n.tbl.length;i++)for(var l in n.tbl[i])r=n.st[l]?n.st[l].type:"","text"==r||"text2"==r||"number"==r||"timeMMSS99"==r?o+=n.tbl[i][l]||"":0==r.indexOf("file")&&n.tbl[i][l]&&(o+=n.tbl[i][l].data||"");return[{str:o}]},uxWgtDataTbl=xa;
